# {{ config.name }} - AWS Deployment
# Generated by: bedsheet deploy --target aws

.PHONY: help setup synth deploy destroy bootstrap

REGION = {{ aws.region or 'eu-central-1' }}

help:
	@echo "{{ config.name }} - AWS Deployment"
	@echo ""
	@echo "Commands:"
	@echo "  make setup     - Create venv and install CDK dependencies"
	@echo "  make bootstrap - Bootstrap CDK in your AWS account (run once)"
	@echo "  make synth     - Synthesize CloudFormation template"
	@echo "  make deploy    - Deploy to AWS"
	@echo "  make destroy   - Destroy all resources"

setup:
	uv venv
	uv pip install -r pyproject.toml
	cd lambda && uv pip install -r requirements.txt --target .

bootstrap:
	cdk bootstrap aws://$(shell aws sts get-caller-identity --query Account --output text)/$(REGION)

synth:
	cdk synth

deploy:
	cdk deploy --require-approval never

destroy:
	cdk destroy --force
